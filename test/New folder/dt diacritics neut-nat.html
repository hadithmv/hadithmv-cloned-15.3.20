<!DOCTYPE html>
<html lang="en">

<head>
	<title></title>

	<meta name="description" content="">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	
	<link href="ntable_style.css" rel="stylesheet" type="text/css" />

	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

	<!--SEMANTIC UI CSS-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.6/semantic.min.css" rel="stylesheet" type="text/css" />

    <link href="https://cdn.datatables.net/1.10.15/css/dataTables.semanticui.min.css" rel="stylesheet" type="text/css" />

    <link href="https://cdn.datatables.net/buttons/1.3.1/css/buttons.semanticui.min.css" rel="stylesheet" type="text/css" />

         

	<style type="text/css">
		html {
			-webkit-text-size-adjust: none;
		}

		
		h1 {
			margin: 0 0 6px 0;
			font-size: 20px;
			color: black;
		}

		h2 {
			font-weight: normal;
			color: #666;
			font-size: 14px;
			margin: 0 0 22px 0;
		}

		.footnotes {
			margin-bottom: 20px;
		}

		.footnotes h4 {
			margin: 2px 0 7px 0;
			color: #666;
			font-size: 11px;
		}

		.footnotes p,
		.footer p {
			margin: 2px 0 0 0;
			font-size: 11px;
			line-height: 1.3;
			color: #808080;
		}

		a,
		a:link,
		a:visited {
			color: #4774CC;
			text-decoration: none;
		}

		a:hover,
		a:active {
			opacity: 0.7;
		}
		/*custom styles*/
    table {
      width: 100%;
    }
		table,
		th {
			text-align: center;
		}
		/*make odd rows lightblue*/

		.table-striped > tbody > tr:nth-child(odd) > td {
			background-color: #f4f7ff;
		}


		/*fit search boxes within columns*/
thead input { width: 100%; }

/*vertically aligns column text to top*/
table.dataTable tbody td { vertical-align: top; }

/*aligns and directs text in select columns, sets fonts*/
.dataTable tbody td.col_1 {
    text-align: left; 
    direction: ltr; }
.dataTable tbody td.col_2 {
    text-align: center; }
.dataTable tbody td.col_3 {
    text-align: right;
    direction: ltr;
}

/*top and botton margin spacing between cells*/
.dataTable td { 
    margin: 15px 0;}
    
	</style>
</head>

<body>
	<div class="row">
		<div class="col-xs-12">
			<h1></h1>
			<p></p>
			
		</div>
	</div>

	<div class="row">
		<div class="col-xs-12">
			<div id="ntable_insert"></div>
		</div>
	</div>

	<div class="row">
		<div class="col-xs-12">
			<div class="footnotes">
				<h4></h4>
				<p></p>
			</div>
		</div>

		<div class="col-xs-12">
			<div class="footer">
				<p></a>
				</p>
				<p></p>
			</div>
		</div>

	</div>




	<!--JS LIBRARIES-->

    <!--JQUERY-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- DATATABLES JS -->
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
    
    <!-- TableTop JS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.2/tabletop.min.js"></script>

   <!-- DATATABLES BUTTONS JS -->
<script type="text/javascript" src="https://cdn.rawgit.com/hadithmv/hadithmv.github.io/66dc3c91/test/dataTables.buttons.min.js"></script>
<!--Previously 1.3.1 -->

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js
"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js
"></script>

<script type="text/javascript" src="https://cdn.rawgit.com/hadithmv/hadithmv.github.io/66dc3c91/test/buttons.html5.min.js"></script>
<!--Previously 1.3.1 -->

<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.print.min.js"></script>

<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.colVis.min.js"></script>

<!-- Semantic UI JS -->
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/dataTables.semanticui.min.js"></script>

<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.semanticui.min.js"></script>

<!-- MARK JS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/mark.js/8.6.0/jquery.mark.min.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/datatables.mark.js/2.0.0/datatables.mark.min.js"></script>



    <script src="ntable_script.js" type="text/javascript"></script>





<script type="text/javascript">
	

//google sheets key

        var key = "https://docs.google.com/spreadsheets/d/1If9RREmbEsXbp-LikCSCDfrfk0CUkEGVEp5XdyrhYUs/pubhtml?gid=489792061&single=true";
        var columns = [
            {"data":"no",    "title":"#"},
            {"data":"arab",  "title":"Arabic"},
            {"data":"eng",   "title":"English"},
            {"data":"dhiv",  "title":"Dhivehi"},
            {"data":"ref",   "title":"Ref."},
            //{"data":"dvRef",   "title":"Dv Ref."},
            //{"data":"arRef",   "title":"Ar Ref."},
            ];

$(document).ready(function() {

  function initializeTabletopObject() {
    Tabletop.init({
      key: key,
      callback: function(data, tabletop) {
          //call up datatables function
          writeTable(data); },
      simpleSheet: true,
       debug: false
                 });
  }

  initializeTabletopObject();

  function writeTable(data) {
    
    //select main div and insert table into html
     $('#ntable_insert').html(
      '<table cellpadding="0" cellspacing="0" border="0" class="ui very basic small striped table table-condensed table-responsive" id="mySelection"></table>'
    ); //End of table insert
      
     // Add header to table
 $("#mySelection").append('<thead><tr><th>#</th><th>Arabic</th><th>English</th><th>Dhivehi</th><th>Ref.</th></tr><tr><th>#</th><th>Arabic</th><th>English</th><th>Dhivehi</th><th>Ref.</th></tr></thead>'); //End of add header

 //<th>#</th><th>Arabic</th><th>English</th><th>Dhivehi</th><th>Ref.</th>


//Accent neutralize

jQuery.fn.DataTable.ext.type.search.string = function ( data ) {
    return ! data ?
        '' :
        typeof data === 'string' ?
            data

                .replace( /\u0780/g, '\u0799' ) //.replace( /ހ/g, 'ޙ' )
                .replace( /\u0780/g, '\u079A' ) //.replace( /ހ/g, 'ޚ' )
                .replace( /\u0792/g, '\u079B' ) //.replace( /ޒ/g, 'ޛ' )
                .replace( /\u0792/g, '\u079F' ) //.replace( /ޒ/g, 'ޟ' )
                .replace( /\u0792/g, '\u07A1' ) //.replace( /ޒ/g, 'ޡ' )
                .replace( /\u0787/g, '\u07A2' ) //.replace( /އ/g, 'ޢ' )
                .replace( /\u0788/g, '\u07A5' ) //.replace( /ވ/g, 'ޥ' )
                .replace( /\u078C/g, '\u07A0' ) //.replace( /ތ/g, 'ޠ' )
                .replace( /\u0790/g, '\u0798' ) //.replace( /ސ/g, 'ޘ' )
                .replace( /\u0790/g, '\u079E' ) //.replace( /ސ/g, 'ޞ' )
                .replace( /\u0780/g, '\u07A4' ) //.replace( /ގ/g, 'ޤ' )
                .replace( /\u0780/g, '\u07A3' ) //.replace( /ގ/g, 'ޢ' )

                .replace( /έ/g, 'ε' )
                .replace( /[ύϋΰ]/g, 'υ' )
                .replace( /ό/g, 'ο' )
                .replace( /ώ/g, 'ω' )
                .replace( /ά/g, 'α' )
                .replace( /[ίϊΐ]/g, 'ι' )
                .replace( /ή/g, 'η' )
                .replace( /\n/g, ' ' )
                .replace( /á/g, 'a' )
                .replace( /é/g, 'e' )
                .replace( /í/g, 'i' )
                .replace( /ó/g, 'o' )
                .replace( /ú/g, 'u' )
                .replace( /ê/g, 'e' )
                .replace( /î/g, 'i' )
                .replace( /ô/g, 'o' )
                .replace( /è/g, 'a' )
                .replace( /ï/g, 'i' )
                .replace( /ü/g, 'u' )
                .replace( /ã/g, 'a' )
                .replace( /õ/g, 'o' )
                .replace( /ç/g, 'c' )
                .replace( /ì/g, 'i' ) :
            data;
};  


    //initialize the DataTable object and put settings in
     table=$("#mySelection").DataTable({

      "orderCellsTop": true, //Moves the sorting icons to the first header row
      "mark": true,
      "autoWidth": false,
      "data": data,
      "columns": columns,
      "order": [[0, "asc"]], //display order on column
      "pagingType": "simple",
      "lengthMenu": [ 10, 2, 3, 5, 100 ], //display range of pages
      "columnDefs": [ { className: "col_1", "targets": [0] },
                      { className: "col_2", "targets": [1] },
                      { className: "col_3", "targets": [2] } ], //select columns to css aligns
      "language": {"search": "Search globally  "},
      "buttons": [

                 {extend: 'copy',
                  text: '<i class="fa fa-files-o"></i>',
                  messageTop: 'top message',

                  customize: function( data ) {
        console.log(JSON.stringify(data));
      // code to manipulate the data string as desired
      data= data.replace( /\t/g, '\n\n' );
      data= data.replace( /\nCompany/, '' );
      data= data.replace( /Claims/, '' );
              return data; }, //edits regex 

                  exportOptions: {columns: [':visible'],
                                  rows: [':visible']   } //copies currently displayed columns and rows
                 },
                 {extend: 'excel',
                  text: '<i class="fa fa-file-excel-o"></i>',
                  exportOptions: {columns: [':visible'],
                                  rows: [':visible']   }
                 },
                 {extend: 'print',
                  text: '<i class="fa fa-print"></i>',

customize: function (win){
                    $(win.document.body).find('table').css('text-align', 'right');
                            
},
                        

                  exportOptions: {columns: [':visible'],
                                  rows: [':visible']   }
                 },
                 {extend: 'colvis',
                  text: '<i class="fa fa-eye-slash"></i>'}],
            
       //uncomment these options to simplify your table
        //"paging": false,
        //"searching": false,
        //"info": false
      
   }); //End of DataTable initialize

// Remove accented character from search input as well
      $('#mySelection_filter input').keyup( function () {
        table
          .search(
            $.fn.DataTable.ext.type.search.string( this.value )
          )
          .draw()
      } );


// Setup - places the input (of each cell) in the second header row
    $('#mySelection thead tr:eq(1) th').each( function () {
        var title = $(this).text();
        $(this).html( '<input type="text" placeholder="Search '+title+'" class="column_search" />' );
    }); //End of second row header input
      
      //Apply Buttons
      table.buttons().container()
        .appendTo( $('div.eight.column:eq(0)', table.table().container()) ); //End of buttons
      
      //Apply the header search event handler
    $( '#mySelection thead'  ).on( 'keyup', ".column_search",function () {
        table
            .column( $(this).parent().index() )
            .search( $.fn.DataTable.ext.type.search.string( this.value ) )
            .draw();
          }); //End of search handler
      
  }
});
//end of writeTable

</script>

</body>
</html>